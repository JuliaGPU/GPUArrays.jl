<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interface · GPUArrays.jl</title><meta name="title" content="Interface · GPUArrays.jl"/><meta property="og:title" content="Interface · GPUArrays.jl"/><meta property="twitter:title" content="Interface · GPUArrays.jl"/><meta name="description" content="Documentation for GPUArrays.jl."/><meta property="og:description" content="Documentation for GPUArrays.jl."/><meta property="twitter:description" content="Documentation for GPUArrays.jl."/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-154489943-6"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-154489943-6', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="GPUArrays.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GPUArrays.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Interface</a><ul class="internal"><li><a class="tocitem" href="#Host-abstractions"><span>Host abstractions</span></a></li><li><a class="tocitem" href="#Caching-Allocator"><span>Caching Allocator</span></a></li></ul></li><li><span class="tocitem">Functionality</span><ul><li><a class="tocitem" href="../functionality/host/"><code>AbstractGPUArray</code></a></li><li><a class="tocitem" href="../functionality/device/"><code>AbstractDeviceArray</code></a></li></ul></li><li><a class="tocitem" href="../testsuite/">Test suite</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interface</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGPU/GPUArrays.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGPU/GPUArrays.jl/blob/master/docs/src/interface.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Interface"><a class="docs-heading-anchor" href="#Interface">Interface</a><a id="Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Interface" title="Permalink"></a></h1><p>To extend the above functionality to a new array type, you should use the types and implement the interfaces listed on this page. GPUArrays is designed around having two different array types to represent a GPU array: one that exists only on the host, and one that actually can be instantiated on the device (i.e. in kernels). Device functionality is then handled by <a href="https://github.com/JuliaGPU/KernelAbstractions.jl">KernelAbstractions.jl</a>.</p><h2 id="Host-abstractions"><a class="docs-heading-anchor" href="#Host-abstractions">Host abstractions</a><a id="Host-abstractions-1"></a><a class="docs-heading-anchor-permalink" href="#Host-abstractions" title="Permalink"></a></h2><p>You should provide an array type that builds on the <code>AbstractGPUArray</code> supertype, such as:</p><pre><code class="language-julia hljs">mutable struct CustomArray{T, N} &lt;: AbstractGPUArray{T, N}
    data::DataRef{Vector{UInt8}}
    offset::Int
    dims::Dims{N}
    ...
end
</code></pre><p>This will allow your defined type (in this case <code>JLArray</code>) to use the GPUArrays interface where available. To be able to actually use the functionality that is defined for <code>AbstractGPUArray</code>s, you need to define the backend, like so:</p><pre><code class="language-julia hljs">import KernelAbstractions: Backend
struct CustomBackend &lt;: KernelAbstractions.GPU
KernelAbstractions.get_backend(a::CA) where CA &lt;: CustomArray = CustomBackend()</code></pre><p>There are numerous examples of potential interfaces for GPUArrays, such as with <a href="https://github.com/JuliaGPU/GPUArrays.jl/blob/master/lib/JLArrays/src/JLArrays.jl">JLArrays</a>, <a href="https://github.com/JuliaGPU/CUDA.jl/blob/master/src/gpuarrays.jl">CuArrays</a>, and <a href="https://github.com/JuliaGPU/AMDGPU.jl/blob/master/src/gpuarrays.jl">ROCArrays</a>.</p><h2 id="Caching-Allocator"><a class="docs-heading-anchor" href="#Caching-Allocator">Caching Allocator</a><a id="Caching-Allocator-1"></a><a class="docs-heading-anchor-permalink" href="#Caching-Allocator" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GPUArrays.@cached" href="#GPUArrays.@cached"><code>GPUArrays.@cached</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@cached cache expr</code></pre><p>Evaluate <code>expr</code> using allocations cache <code>cache</code>.</p><p>When GPU memory is allocated during the execution of <code>expr</code>, <code>cache</code> will first be checked. If no memory is available in the cache, a new allocation will be requested.</p><p>After the execution of <code>expr</code>, all allocations made under the scope of <code>@cached</code> will be cached within <code>cache</code> for future use. This is useful to avoid relying on GC to free GPU memory in time.</p><p>Once <code>cache</code> goes out scope, or when the user calls <code>unsafe_free!</code> on it, all cached allocations will be freed.</p><p><strong>Example</strong></p><p>In the following example, each iteration of the for-loop requires 8 GiB of GPU memory. Without caching those allocations, significant pressure would be put on the GC, resulting in high memory usage and latency. By using the allocator cache, the memory usage is stable:</p><pre><code class="language-julia hljs">cache = GPUArrays.AllocCache()
for i in 1:1000
    GPUArrays.@cached cache begin
        sin.(CUDA.rand(Float32, 1024^3))
    end
end

# optionally: free the memory now, instead of waiting for the GC to collect `cache`
GPUArrays.unsafe_free!(cache)</code></pre><p>See <a href="#GPUArrays.@uncached"><code>@uncached</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/GPUArrays.jl/blob/3c16583dce63972a267b021cac841fbd19ec26df/src/host/alloc_cache.jl#L114-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GPUArrays.@uncached" href="#GPUArrays.@uncached"><code>GPUArrays.@uncached</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@uncached expr</code></pre><p>Evaluate expression <code>expr</code> without using the allocation. This is useful to call from within <code>@cached</code> to avoid caching some allocations, e.g., because they can be returned out of the <code>@cached</code> scope.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/GPUArrays.jl/blob/3c16583dce63972a267b021cac841fbd19ec26df/src/host/alloc_cache.jl#L158-L164">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../functionality/host/"><code>AbstractGPUArray</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Monday 30 June 2025 16:58">Monday 30 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
